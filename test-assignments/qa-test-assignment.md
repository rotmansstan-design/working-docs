# Тестовое задание: QA Automation Engineer

## Цель задания

Проверить, как кандидат мыслит как QA-инженер в финансово-критичном продукте:
- умеет выделять риски и приоритеты;
- строит практичную стратегию автоматизации;
- обеспечивает надежность критических пользовательских флоу;
- аргументирует технические решения.

## Контекст

Есть упрощенный сценарий вывода средств:
1. Пользователь создает заявку на вывод.
2. Сервис проверяет баланс и ставит заявку в `pending`.
3. Подтверждение заявки переводит ее в `completed`.

API (доступен как локальный сервис или мок):
- `POST /v1/withdrawals`
- `GET /v1/withdrawals/{id}`
- `POST /v1/withdrawals/{id}/confirm`

## Что нужно сделать

Построить мини-набор QA-автоматизации для этого флоу:
1. E2E-покрытие ключевого пользовательского пути.
2. API-автотесты с позитивными и граничными сценариями.
3. Базовый подход к нагрузочному/устойчивостному тесту.
4. Короткая стратегия тестирования и интеграции в CI.

## Требуемые артефакты

1. Автотесты:
- E2E (Playwright или Cypress);
- API (любой удобный стек: Playwright API, supertest, Postman/newman и т.д.).
2. `TEST_STRATEGY.md`:
- scope тестирования;
- приоритизация рисков;
- что автоматизируется сейчас, что позже и почему.
3. `README.md`:
- как запускать тесты локально;
- как запускать в CI;
- ограничения текущего покрытия.
4. Пример CI-конфига (GitHub Actions или аналог), который запускает тесты.

## Обязательные тестовые сценарии

### E2E (минимум)

- Успешное создание заявки на вывод.
- Ошибка при недостаточном балансе.
- Защита от двойного submit (двойной клик или быстрые повторы).
- Проверка, что пользователь видит финальный статус заявки.

### API (минимум)

- `POST /withdrawals`: happy-path.
- `POST /withdrawals`: `amount <= 0`.
- `POST /withdrawals`: идемпотентность по `idempotency_key`:
  - тот же ключ + тот же payload -> тот же результат;
  - тот же ключ + другой payload -> ошибка (`422` или эквивалент).
- `POST /withdrawals/{id}/confirm`: повторный confirm не ломает состояние.

### Устойчивость/нагрузка (минимум)

- 1 сценарий на конкурирующие или частые запросы к `POST /withdrawals`:
  - цель: выявить дубли/ошибки консистентности;
  - инструмент: k6 или любой эквивалент;
  - достаточно короткого smoke-набора.

## Фокус на качестве

Важно показать:
- как вы выбираете, что критично для бизнеса;
- какие инварианты системы проверяете;
- как из падения теста быстро прийти к root cause.

## Что можно упростить

- Один пользователь и одна валюта (`USDT`).
- Без реальных платежных/крипто-интеграций.
- Без сложной инфраструктуры окружений.

## Технические ограничения

- TypeScript предпочтительно.
- Проект должен запускаться локально одной командой или понятной последовательностью.
- Внешние платные инструменты не требуются.

## Объем и время

- Ориентир: 4-6 часов.
- Важнее глубина тест-дизайна и инженерной аргументации, чем количество тестов.

## Что особенно оценивается

- Умение мыслить от рисков, а не от “максимума кейсов”.
- Качество тест-кейсов на граничные и финансово-критичные сценарии.
- Осмысленная интеграция тестов в CI и работа с флейками/нестабильностью.
