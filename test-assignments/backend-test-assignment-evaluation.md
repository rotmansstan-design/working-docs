# Критерии проверки: Backend Test Assignment (Go + PostgreSQL)

## Принцип оценки

Оценивается не объем кода, а качество инженерного мышления:  
насколько кандидат строит надежную финансовую логику, аргументирует решения и контролирует риски.

Итоговая оценка: **100 баллов**.

## 1) Корректность бизнес-логики — 25 баллов

Проверяем:
- корректный happy-path create/confirm;
- валидация входных данных;
- корректные статусы и ошибки (`400/409/422` и др.);
- отсутствие неконсистентных переходов статусов.

Сильный сигнал:
- все базовые сценарии покрыты;
- поведение API предсказуемое и устойчивое к повторным запросам.

Слабый сигнал:
- подтверждение списывает средства повторно;
- возможны некорректные статусы (`completed -> pending` и т.п.).

## 2) Консистентность и конкурентный доступ — 25 баллов

Проверяем:
- защита от двойного списания;
- корректная работа транзакций;
- осознанный выбор блокировок/изоляции;
- наличие DB-ограничений для защиты инвариантов.

Сильный сигнал:
- явно описано, почему выбран именно такой подход;
- конкурентный тест воспроизводимо подтверждает корректность.

Слабый сигнал:
- логика "на проверках в коде" без надежной защиты на уровне БД;
- race-condition при параллельных запросах.

## 3) Идемпотентность — 15 баллов

Проверяем:
- корректная обработка повторов с тем же `idempotency_key`;
- возврат исходного результата для идентичного payload;
- конфликт при том же ключе и другом payload.

Сильный сигнал:
- идемпотентность реализована на уровне хранилища и транзакций;
- отсутствуют дубли withdrawal.

Слабый сигнал:
- идемпотентность частично in-memory и ломается при рестарте/конкуренции.

## 4) Качество кода и архитектуры — 15 баллов

Проверяем:
- разделение слоев (handler/service/repository или эквивалент);
- читаемость и именование;
- обработка ошибок и технический долг;
- минимально разумная расширяемость.

Сильный сигнал:
- код легко читать, инварианты зафиксированы в одном месте;
- нет скрытой магии, ясные контракты между слоями.

Слабый сигнал:
- “толстые” хэндлеры, смешение бизнес-логики и SQL/HTTP деталей.

## 5) Тестовая стратегия — 15 баллов

Проверяем:
- unit + integration;
- минимум один конкурентный сценарий;
- тесты проверяют бизнес-инварианты, а не только статус-коды.

Сильный сигнал:
- тесты короткие, репрезентативные, ловят регрессии по критичным местам.

Слабый сигнал:
- только happy-path;
- нет тестов на конкуренцию/идемпотентность.

## 6) Документация и инженерная зрелость — 5 баллов

Проверяем:
- понятный `README`;
- перечислены компромиссы и ограничения;
- обозначен план усиления решения для production.

Сильный сигнал:
- кандидат явно отделяет “сделано сейчас” от “что нужно для боевого уровня”.

Слабый сигнал:
- README не объясняет ключевые проектные решения.

## Красные флаги (автоматическое существенное снижение)

- Двойное списание возможно при параллельных запросах.
- Отсутствует идемпотентность create.
- Критичные инварианты держатся только в памяти процесса.
- Нет ни одного теста на финансово-критичный крайний случай.

## Интерпретация итогового балла

- **85-100**: Strong hire (сильная инженерная база, зрелое мышление).
- **70-84**: Hire (хороший уровень, есть зоны роста).
- **55-69**: Borderline (нужна доп.тех-интервью проверка по слабым зонам).
- **<55**: No hire (риски для финансово-критичной backend-логики).

## Рекомендации интервьюеру

- На разборе попросить кандидата изменить одно правило (например, частичный вывод или multi-currency) и оценить, как он адаптирует модель.
- Уточнить, какие решения были осознанным компромиссом из-за времени.
- Проверить глубину понимания транзакций и блокировок на примерах из его кода.
